<?xml version="1.0" ?>

<!-- =====================================================================

 Build file for CsvJdbc. This uses Apache Ant v1.5
 
 Authors: Jonathan Ackerman, Michael Maraya
 Version: $Id: build.xml,v 1.9 2002/08/25 03:29:39 mmaraya Exp $

 CsvJdbc - a JDBC driver for CSV files
 Copyright (C) 2001  Jonathan Ackerman

 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
 version 2.1 of the License, or (at your option) any later version.

 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.

 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

====================================================================== -->

<project name="CsvJdbc" default="main">

  <!-- =================================================================== -->
  <!-- Project-wide properties and paths                                   -->
  <!-- =================================================================== -->
  <property name="name" value="csvjdbc"/>
  <property name="rel" value="r0-8"/>
  <property name="rel.name" value="${name}-${rel}"/>  
  <property name="build.dir" value="../build"/> 
  <property name="src.dir" value="../src"/>
  <property name="java.dir" value="${src.dir}/java"/>
  <property name="doc.dir" value="${src.dir}/doc"/>
  <property name="lib.dir" value="../lib"/>
  <property name="class.dir" value="../classes"/>
  <property name="javadoc.dir" value="../javadoc"/> 
  <property name="rel.dir" value="../release"/>
  <property name="jar.file" value="${rel.dir}/${name}.jar"/>
  <path id="classpath">
    <pathelement path="."/>
    <pathelement path="${class.dir}"/>
    <fileset dir="${lib.dir}">
      <include name="**/*.jar"/>
    </fileset>
  </path>    

  <!-- =================================================================== -->
  <!-- Initialization target                                               -->
  <!-- =================================================================== -->
  <target name="init">        
    <mkdir dir="${class.dir}"/>
    <mkdir dir="${javadoc.dir}"/>
    <mkdir dir="${rel.dir}"/>
  </target>
  
  <!-- =================================================================== -->
  <!-- Main target                                                         -->
  <!-- =================================================================== -->
  <target name="main" depends="init">
    <echo message="Build File for ${name} Release ${rel}"/>
    <echo message=""/>
    <echo message="Targets are:"/>
    <echo message=""/>
    <echo message="  clean    - Cleans project for fresh build"/>
    <echo message="  compile  - Compiles all code"/>
    <echo message="  jar      - Creates the jar file for the system"/>       
    <echo message="  release  - Builds a release of the system"/>
    <echo message="  javadoc  - Builds the javadoc for the system"/>    
    <echo message="  test     - Creates and runs the test programs. See lib\readme.txt"/>  
  </target>
  
  <!-- =================================================================== -->
  <!-- Compile target                                                      -->
  <!-- =================================================================== -->
  <target name="compile" depends="init">
    <javac srcdir="${java.dir}" destdir="${class.dir}">
      <classpath refid="classpath"/>
      <include name="org/**/*.java"/>
    </javac>
  </target>

  <!-- =================================================================== -->
  <!-- Jar target                                                          -->
  <!-- =================================================================== -->
  <target name="jar" depends="compile">
    <jar destfile="${jar.file}">
      <fileset dir="${class.dir}" includes="org/**/*.class"/>
    </jar>
  </target>  
  
  <!-- =================================================================== -->
  <!-- Javadoc target                                                      -->
  <!-- =================================================================== -->
  <target name="javadoc" depends="init">
    <javadoc packagenames="test.*,org.*"
             sourcepath="${java.dir}"
             destdir="${javadoc.dir}"
             author="true"
             version="true"
             private="true"
             doctitle="${name} java documentation (release ${rel})"
             windowtitle="${name} java documentation (release ${rel})"
             bottom="Check out &lt;a href=&quot;http://csvjdbc.sourceforge.net&quot;&gt;http://csvjdbc.sourceforge.net&lt;/a&gt; for more info.">
      <classpath refid="classpath"/>
    </javadoc>
  </target>
  
  <!-- =================================================================== -->
  <!-- Clean target                                                        -->
  <!-- =================================================================== -->
  <target name="clean">  
    <delete dir="${class.dir}"/>
    <delete dir="${javadoc.dir}"/>
    <delete dir="${rel.dir}"/>
  </target>
  
  <!-- =================================================================== -->
  <!-- Test target                                                         -->
  <!-- =================================================================== -->
  <target name="test" depends="compile">
    <javac srcdir="${java.dir}" destdir="${class.dir}">
      <classpath refid="classpath"/>
      <include name="test/**/*.java"/>
    </javac>
    <java classname="test.org.relique.jdbc.csv.RunTests" fork="yes" 
          failonerror="yes">
      <classpath refid="classpath"/>
      <arg value="../src/testdata"/> 
    </java>
  </target>  
    
  <!-- =================================================================== -->
  <!-- Release target                                                      -->
  <!-- =================================================================== -->
  <target name="release" depends="clean,test,jar,javadoc">
    <zip destfile="${rel.dir}/${rel.name}.zip">
      <zipfileset dir="${javadoc.dir}" includes="**/*" 
                  prefix="${rel.name}/javadoc"/>
      <zipfileset dir="${java.dir}" includes="**/*" prefix="${rel.name}/src"/>
      <zipfileset dir="${rel.dir}" includes="*.jar" prefix="${rel.name}"/>
      <zipfileset dir="${doc.dir}" includes="**" prefix="${rel.name}"/>
    </zip>
  </target>
  
  
</project>  